# CEX Web3 å¹³å° - æ¶æ§‹èªªæ˜

ğŸŒ [English](./ARCHITECTURE.md) | **ç¹é«”ä¸­æ–‡**

## ç³»çµ±æ¦‚è¦½

CEX Web3 æ˜¯ä¸€å€‹æ¡ç”¨ç¾ä»£æŠ€è¡“å»ºæ§‹çš„å…¨ç«¯åŠ å¯†è²¨å¹£äº¤æ˜“æ‰€å¹³å°ï¼Œå°ˆç‚ºå¯æ“´å±•æ€§ã€å®‰å…¨æ€§å’Œå¤šéˆæ”¯æ´è€Œè¨­è¨ˆã€‚

---

## æŠ€è¡“æ£§

| å±¤ç´š | æŠ€è¡“ | ç”¨é€” |
|------|------|------|
| **å¾Œç«¯** | NestJS 11 + TypeScript | API ä¼ºæœå™¨ã€æ¥­å‹™é‚è¼¯ |
| **è³‡æ–™åº«** | PostgreSQL + Prisma | æŒä¹…åŒ–è³‡æ–™å„²å­˜ |
| **å¿«å–** | Redis | æœƒè©±ã€é€Ÿç‡é™åˆ¶ã€åƒ¹æ ¼å¿«å– |
| **ç¶²é å‰ç«¯** | Next.js 15 + React 19 | äº¤æ˜“ä»‹é¢ |
| **ç®¡ç†å¾Œå°** | Next.js 15 | ç®¡ç†æ§åˆ¶é¢æ¿ |
| **è¡Œå‹•è£ç½®** | Flutter 3.x | iOS & Android æ‡‰ç”¨ |
| **å³æ™‚é€šè¨Š** | Socket.IO (WebSocket) | äº¤æ˜“å¼•æ“ã€å³æ™‚æ›´æ–° |

---

## å¾Œç«¯æ¨¡çµ„

NestJS å¾Œç«¯ç”± 30+ å€‹å°ˆæ¥­æ¨¡çµ„çµ„æˆï¼š

### æ ¸å¿ƒäº¤æ˜“
| æ¨¡çµ„ | èªªæ˜ |
|------|------|
| `engine/` | å³æ™‚è¨‚å–®æ’®åˆå¼•æ“ï¼ˆWebSocketï¼‰ |
| `orders/` | è¨‚å–® CRUDã€è¨‚å–®ç°¿ç®¡ç† |
| `trade/` | äº¤æ˜“åŸ·è¡Œå’Œçµç®— |
| `market/` | å¸‚å ´æ•¸æ“šã€äº¤æ˜“å°ã€åƒ¹æ ¼é è¨€æ©Ÿ |

### éŒ¢åŒ…èˆ‡å€å¡Šéˆ
| æ¨¡çµ„ | èªªæ˜ |
|------|------|
| `wallet/` | ç†±éŒ¢åŒ…ç®¡ç†ã€HD æ¨å° |
| `deposit/` | å¤šéˆå……å€¼æƒæå™¨ |
| `withdrawal/` | æç¾è™•ç†ã€ç®¡ç†å“¡å¯©æ‰¹ |
| `blockchain/` | éˆæä¾›è€…æŠ½è±¡å±¤ |

### ç”¨æˆ¶èˆ‡å®‰å…¨
| æ¨¡çµ„ | èªªæ˜ |
|------|------|
| `auth/` | JWT èªè­‰ã€é›™å› ç´ èªè­‰ï¼ˆTOTPï¼‰ã€æœƒè©± |
| `users/` | ç”¨æˆ¶è³‡æ–™ç®¡ç† |
| `kyc/` | KYC ç­‰ç´šç®¡ç† |
| `aml/` | åæ´—éŒ¢è­¦å ± |
| `security/` | é€Ÿç‡é™åˆ¶ã€å¯©è¨ˆæ—¥èªŒ |

### ç®¡ç†
| æ¨¡çµ„ | èªªæ˜ |
|------|------|
| `admin/` | ç®¡ç†ç«¯é» |
| `notification/` | æ¨æ’­é€šçŸ¥åŸºç¤è¨­æ–½ |
| `referral/` | æ¨è–¦ç³»çµ±èˆ‡çå‹µ |
| `fee/` | äº¤æ˜“æ‰‹çºŒè²»é…ç½® |

---

## å€å¡Šéˆæä¾›è€…æ¶æ§‹

æ¯å€‹å€å¡Šéˆéƒ½å¯¦ä½œç‚ºç¨ç«‹çš„æä¾›è€…ï¼Œéµå¾ªé€šç”¨ä»‹é¢ï¼š

```typescript
interface ChainProvider {
  // åœ°å€ç”Ÿæˆ
  generateAddress(userId: string): Promise<string>;
  
  // é¤˜é¡æŸ¥è©¢
  getBalance(address: string): Promise<bigint>;
  getTokenBalance(address: string, token: string): Promise<bigint>;
  
  // äº¤æ˜“è™•ç†
  sendTransaction(params: TxParams): Promise<string>;
  getTransaction(txHash: string): Promise<TxInfo>;
  
  // å……å€¼æƒæ
  scanDeposits(fromBlock: number): Promise<Deposit[]>;
}
```

### æ”¯æ´çš„æä¾›è€…

| æä¾›è€… | æ”¯æ´çš„éˆ | ä»£å¹£ |
|--------|----------|------|
| `evm.provider.ts` | Ethereumã€BSCã€Polygonã€Arbitrum | ETHã€ERC-20 |
| `bitcoin.provider.ts` | Bitcoin | BTC |
| `litecoin.provider.ts` | Litecoin | LTC |
| `dogecoin.provider.ts` | Dogecoin | DOGE |
| `solana.provider.ts` | Solana | SOLã€SPL |
| `tron.provider.ts` | Tron | TRXã€TRC-20 |
| `ton.provider.ts` | TON | TONã€Jettons |
| `cardano.provider.ts` | Cardano | ADA |
| `polkadot.provider.ts` | Polkadot | DOT |

---

## è³‡æ–™åº«çµæ§‹ï¼ˆç°¡åŒ–ç‰ˆï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     User     â”‚       â”‚    Order     â”‚       â”‚    Trade     â”‚
â”‚    ï¼ˆç”¨æˆ¶ï¼‰    â”‚       â”‚   ï¼ˆè¨‚å–®ï¼‰    â”‚       â”‚   ï¼ˆæˆäº¤ï¼‰    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id           â”‚â”€â”€â”    â”‚ id           â”‚â”€â”€â”    â”‚ id           â”‚
â”‚ email        â”‚  â”‚    â”‚ userId       â”‚  â”‚    â”‚ buyerOrderId â”‚
â”‚ passwordHash â”‚  â”‚    â”‚ symbol       â”‚  â”‚    â”‚ sellerOrderIdâ”‚
â”‚ role         â”‚  â”‚    â”‚ side         â”‚  â””â”€â”€â”€â–¶â”‚ price        â”‚
â”‚ kycLevel     â”‚  â”‚    â”‚ type         â”‚       â”‚ quantity     â”‚
â”‚ twoFactor    â”‚  â”‚    â”‚ price        â”‚       â”‚ timestamp    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚ quantity     â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚    â”‚ status       â”‚
                  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚    â”‚   Account    â”‚       â”‚ Transaction  â”‚
                  â”‚    â”‚   ï¼ˆå¸³æˆ¶ï¼‰    â”‚       â”‚   ï¼ˆäº¤æ˜“ï¼‰    â”‚
                  â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                  â””â”€â”€â”€â–¶â”‚ userId       â”‚       â”‚ id           â”‚
                       â”‚ currency     â”‚       â”‚ userId       â”‚
                       â”‚ balance      â”‚       â”‚ type         â”‚
                       â”‚ locked       â”‚       â”‚ amount       â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ status       â”‚
                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## è¡Œå‹•æ‡‰ç”¨çµæ§‹

Flutter è¡Œå‹•æ‡‰ç”¨æ¡ç”¨ Clean Architecture æ­é… Riverpod ç‹€æ…‹ç®¡ç†ï¼š

```
lib/
â”œâ”€â”€ core/           # é…ç½®ã€æœå‹™ã€æä¾›è€…
â”œâ”€â”€ features/       # åŠŸèƒ½æ¨¡çµ„
â”‚   â”œâ”€â”€ auth/       # ç™»å…¥ã€è¨»å†Šã€é›™å› ç´ èªè­‰
â”‚   â”œâ”€â”€ wallet/     # é¤˜é¡ã€å……å€¼ã€æç¾
â”‚   â”œâ”€â”€ trade/      # äº¤æ˜“ä»‹é¢
â”‚   â”œâ”€â”€ orders/     # è¨‚å–®æ­·å²
â”‚   â”œâ”€â”€ kyc/        # KYC é©—è­‰
â”‚   â”œâ”€â”€ settings/   # å¸³æˆ¶è¨­å®š
â”‚   â””â”€â”€ ...         # å…± 15+ æ¨¡çµ„
â”œâ”€â”€ router/         # GoRouter å°èˆª
â””â”€â”€ l10n/           # æœ¬åœ°åŒ–
```

---

## å®‰å…¨åŠŸèƒ½

| åŠŸèƒ½ | å¯¦ä½œæ–¹å¼ |
|------|----------|
| **èªè­‰** | JWT æ­é… Refresh Token |
| **é›™å› ç´ èªè­‰** | TOTPï¼ˆç›¸å®¹ Google Authenticatorï¼‰ |
| **é€Ÿç‡é™åˆ¶** | å„ç«¯é»ç¨ç«‹ç¯€æµ |
| **å¯©è¨ˆæ—¥èªŒ** | è¨˜éŒ„æ‰€æœ‰æ•æ„Ÿæ“ä½œ |
| **æç¾å¯©æ‰¹** | å¤§é¡æç¾éœ€ç®¡ç†å“¡å¯©æ ¸ |
| **ç†±/å†·éŒ¢åŒ…** | è³‡é‡‘åˆ†é›¢ |
| **API é‡‘é‘°** | æ¬Šé™ç¯„åœï¼ˆè®€å–/äº¤æ˜“/æç¾ï¼‰ |

---

## éƒ¨ç½²é¸é …

| ç’°å¢ƒ | åŸºç¤è¨­æ–½ |
|------|----------|
| **é–‹ç™¼** | Docker Composeï¼ˆPostgreSQLã€Redisã€Mailpitï¼‰ |
| **æ¸¬è©¦** | Railwayã€Render æˆ–é¡ä¼¼ PaaS |
| **ç”Ÿç”¢** | Kubernetes æˆ–å°ˆç”¨ä¼ºæœå™¨æ­é… HSM |

---

*å¦‚éœ€æ›´å¤šè©³æƒ…ï¼Œè«‹è¯ç¹«å–å¾—å•†æ¥­æˆæ¬Šã€‚*

ğŸ“§ **è¯ç¹«æ–¹å¼**: [aa22396584@gmail.com](mailto:aa22396584@gmail.com)
